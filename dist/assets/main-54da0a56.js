import{V as F,C as Le,L as Ye,F as Xe,G as de,B as I,a as V,b as K,M as Ce,P as S,c as Je,d as Fe,e as C,f as E,S as D,g as T,W,h as Ze,i as Ke,j as Y,A as Ae,k as he,T as _e,l as Qe,m as ue,n as ie,o as et,p as tt,q as nt,r as it}from"./papaparse.min-af088632.js";import"https://unpkg.com/three@0.139.0/examples/jsm/libs/tween.module.min.js";const ot=/^[og]\s*(.+)?/,rt=/^mtllib /,st=/^usemtl /,at=/^usemap /,Se=/\s+/,ze=new F,Q=new F,Ve=new F,Pe=new F,j=new F,G=new Le;function lt(){const r={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=e!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(n,o){const l=this._finalize(!1);l&&(l.inherited||l.groupCount<=0)&&this.materials.splice(l.index,1);const p={index:this.materials.length,name:n||"",mtllib:Array.isArray(o)&&o.length>0?o[o.length-1]:"",smooth:l!==void 0?l.smooth:this.smooth,groupStart:l!==void 0?l.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(c){const a={index:typeof c=="number"?c:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return a.clone=this.clone.bind(a),a}};return this.materials.push(p),p},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(n){const o=this.currentMaterial();if(o&&o.groupEnd===-1&&(o.groupEnd=this.geometry.vertices.length/3,o.groupCount=o.groupEnd-o.groupStart,o.inherited=!1),n&&this.materials.length>1)for(let l=this.materials.length-1;l>=0;l--)this.materials[l].groupCount<=0&&this.materials.splice(l,1);return n&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),o}},i&&i.name&&typeof i.clone=="function"){const n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/3)*3},parseNormalIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/3)*3},parseUVIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/2)*2},addVertex:function(t,e,i){const n=this.vertices,o=this.object.geometry.vertices;o.push(n[t+0],n[t+1],n[t+2]),o.push(n[e+0],n[e+1],n[e+2]),o.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){const n=this.normals,o=this.object.geometry.normals;o.push(n[t+0],n[t+1],n[t+2]),o.push(n[e+0],n[e+1],n[e+2]),o.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(t,e,i){const n=this.vertices,o=this.object.geometry.normals;ze.fromArray(n,t),Q.fromArray(n,e),Ve.fromArray(n,i),j.subVectors(Ve,Q),Pe.subVectors(ze,Q),j.cross(Pe),j.normalize(),o.push(j.x,j.y,j.z),o.push(j.x,j.y,j.z),o.push(j.x,j.y,j.z)},addColor:function(t,e,i){const n=this.colors,o=this.object.geometry.colors;n[t]!==void 0&&o.push(n[t+0],n[t+1],n[t+2]),n[e]!==void 0&&o.push(n[e+0],n[e+1],n[e+2]),n[i]!==void 0&&o.push(n[i+0],n[i+1],n[i+2])},addUV:function(t,e,i){const n=this.uvs,o=this.object.geometry.uvs;o.push(n[t+0],n[t+1]),o.push(n[e+0],n[e+1]),o.push(n[i+0],n[i+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,n,o,l,p,c,a){const h=this.vertices.length;let s=this.parseVertexIndex(t,h),d=this.parseVertexIndex(e,h),f=this.parseVertexIndex(i,h);if(this.addVertex(s,d,f),this.addColor(s,d,f),p!==void 0&&p!==""){const g=this.normals.length;s=this.parseNormalIndex(p,g),d=this.parseNormalIndex(c,g),f=this.parseNormalIndex(a,g),this.addNormal(s,d,f)}else this.addFaceNormal(s,d,f);if(n!==void 0&&n!==""){const g=this.uvs.length;s=this.parseUVIndex(n,g),d=this.parseUVIndex(o,g),f=this.parseUVIndex(l,g),this.addUV(s,d,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let i=0,n=t.length;i<n;i++){const o=this.parseVertexIndex(t[i],e);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const i=this.vertices.length,n=this.uvs.length;for(let o=0,l=t.length;o<l;o++)this.addVertexLine(this.parseVertexIndex(t[o],i));for(let o=0,l=e.length;o<l;o++)this.addUVLine(this.parseUVIndex(e[o],n))}};return r.startObject("",!1),r}class X extends Ye{constructor(t){super(t),this.materials=null}load(t,e,i,n){const o=this,l=new Xe(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(p){try{e(o.parse(p))}catch(c){n?n(c):console.error(c),o.manager.itemError(t)}},i,n)}setMaterials(t){return this.materials=t,this}parse(t){const e=new lt;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const i=t.split(`
`);let n=[];for(let p=0,c=i.length;p<c;p++){const a=i[p].trimStart();if(a.length===0)continue;const h=a.charAt(0);if(h!=="#")if(h==="v"){const s=a.split(Se);switch(s[0]){case"v":e.vertices.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3])),s.length>=7?(G.setRGB(parseFloat(s[4]),parseFloat(s[5]),parseFloat(s[6])).convertSRGBToLinear(),e.colors.push(G.r,G.g,G.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));break;case"vt":e.uvs.push(parseFloat(s[1]),parseFloat(s[2]));break}}else if(h==="f"){const d=a.slice(1).trim().split(Se),f=[];for(let u=0,v=d.length;u<v;u++){const w=d[u];if(w.length>0){const y=w.split("/");f.push(y)}}const g=f[0];for(let u=1,v=f.length-1;u<v;u++){const w=f[u],y=f[u+1];e.addFace(g[0],w[0],y[0],g[1],w[1],y[1],g[2],w[2],y[2])}}else if(h==="l"){const s=a.substring(1).trim().split(" ");let d=[];const f=[];if(a.indexOf("/")===-1)d=s;else for(let g=0,u=s.length;g<u;g++){const v=s[g].split("/");v[0]!==""&&d.push(v[0]),v[1]!==""&&f.push(v[1])}e.addLineGeometry(d,f)}else if(h==="p"){const d=a.slice(1).trim().split(" ");e.addPointGeometry(d)}else if((n=ot.exec(a))!==null){const s=(" "+n[0].slice(1).trim()).slice(1);e.startObject(s)}else if(st.test(a))e.object.startMaterial(a.substring(7).trim(),e.materialLibraries);else if(rt.test(a))e.materialLibraries.push(a.substring(7).trim());else if(at.test(a))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(h==="s"){if(n=a.split(" "),n.length>1){const d=n[1].trim().toLowerCase();e.object.smooth=d!=="0"&&d!=="off"}else e.object.smooth=!0;const s=e.object.currentMaterial();s&&(s.smooth=e.object.smooth)}else{if(a==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+a+'"')}}e.finalize();const o=new de;if(o.materialLibraries=[].concat(e.materialLibraries),!(e.objects.length===1&&e.objects[0].geometry.vertices.length===0)===!0)for(let p=0,c=e.objects.length;p<c;p++){const a=e.objects[p],h=a.geometry,s=a.materials,d=h.type==="Line",f=h.type==="Points";let g=!1;if(h.vertices.length===0)continue;const u=new I;u.setAttribute("position",new V(h.vertices,3)),h.normals.length>0&&u.setAttribute("normal",new V(h.normals,3)),h.colors.length>0&&(g=!0,u.setAttribute("color",new V(h.colors,3))),h.hasUVIndices===!0&&u.setAttribute("uv",new V(h.uvs,2));const v=[];for(let y=0,N=s.length;y<N;y++){const z=s[y],Z=z.name+"_"+z.smooth+"_"+g;let m=e.materials[Z];if(this.materials!==null){if(m=this.materials.create(z.name),d&&m&&!(m instanceof K)){const P=new K;Ce.prototype.copy.call(P,m),P.color.copy(m.color),m=P}else if(f&&m&&!(m instanceof S)){const P=new S({size:10,sizeAttenuation:!1});Ce.prototype.copy.call(P,m),P.color.copy(m.color),P.map=m.map,m=P}}m===void 0&&(d?m=new K:f?m=new S({size:1,sizeAttenuation:!1}):m=new Je,m.name=z.name,m.flatShading=!z.smooth,m.vertexColors=g,e.materials[Z]=m),v.push(m)}let w;if(v.length>1){for(let y=0,N=s.length;y<N;y++){const z=s[y];u.addGroup(z.groupStart,z.groupCount,y)}d?w=new Fe(u,v):f?w=new C(u,v):w=new E(u,v)}else d?w=new Fe(u,v[0]):f?w=new C(u,v[0]):w=new E(u,v[0]);w.name=a.name,o.add(w)}else if(e.vertices.length>0){const p=new S({size:1,sizeAttenuation:!1}),c=new I;c.setAttribute("position",new V(e.vertices,3)),e.colors.length>0&&e.colors[0]!==void 0&&(c.setAttribute("color",new V(e.colors,3)),p.vertexColors=!0);const a=new C(c,p);o.add(a)}return o}}let me,J,pe;me=new D;J=new T(75,window.innerWidth/window.innerHeight,.1,1e3);J.position.set(30,-2,30);pe=new W({canvas:document.querySelector("#myCanvasOA")});pe.setSize(window.innerWidth,window.innerHeight);new Ze([new F(30,-2,30),new F(20,5,20),new F(8,5,8)]);let H=new de;me.add(H);J.lookAt(H.position.x,H.position.y+4,H.position.z);let ee=[],ct=new S({color:12774655,size:.001,transparent:!0,opacity:.1});const dt=new X;dt.load("./model/test2.obj",r=>{r.children.forEach(t=>{console.log(r.children);let e=new C(t.geometry,ct);e.position.set(-10,-10,0),H.add(e)})});document.getElementById("scrollContainer");let ht=!1;function He(){requestAnimationFrame(He),H.traverse(r=>{if(r instanceof C&&ht){let t=r.geometry.attributes.position;for(let e=0;e<t.count;e++)t.setXYZ(e,t.getX(e)+ee[e].x,t.getY(e)+ee[e].y,t.getZ(e)+ee[e].z);t.needsUpdate=!0}}),pe.render(me,J)}He();let b=document.getElementById("pHSlider"),oe=document.querySelector(".slider-label");b.addEventListener("input",function(){oe.innerHTML=b.value;let r=(b.value-b.min)/(b.max-b.min)*b.offsetWidth;oe.style.left=r+"px"});function ut(r){return(1-(r-7.9)/.29999999999999893)*(2-1)+1}function mt(r){return(1-(r-7.9)/.29999999999999893)*(.9-.4)+.4}function pt(){let r=ut(parseFloat(b.value)),t=mt(parseFloat(b.value));re.opacity=t,re.needsUpdate=!0,A.attributes.position.array;let e=[];for(let i=0;i<M;i++)for(let n=0;n<M;n++){let o=i*U,l=(Math.random()-.5)*B,p=n*U;if(e.push(o,l,p),Math.random()<r-1){let c=(Math.random()-.5)*B*.1;e.push(o,l+c,p)}}A.setAttribute("position",new V(e,3)),A.attributes.position.needsUpdate=!0}b.addEventListener("input",pt);oe.style.left=(b.value-b.min)/(b.max-b.min)*b.offsetWidth+"px";let Ie=new W({canvas:document.querySelector("#mySecCanvas")});Ie.setSize(window.innerWidth,window.innerHeight/2);let fe=new D,ge=new T(90,window.innerWidth/window.innerHeight,.1,1e3);ge.position.set(12,1,10);ge.lookAt(new F(0));let M=200,U=.25,R=.2,B=2,k=new I,Ee=[];for(let r=0;r<M;r++)for(let t=0;t<M;t++){let e=r*U,i=(Math.random()-.5)*B,n=t*U;Ee.push(e,i,n)}k.setAttribute("position",new V(Ee,3));let ft=new S({color:16777215,size:.03}),gt=new C(k,ft);fe.add(gt);let Ue=[];for(let r=0;r<M;r++)for(let t=0;t<M;t++){let e=r*U,i=(Math.random()-.5)*B,n=t*U;Ue.push(e,i,n)}function vt(r,t){const e=document.createElement("canvas"),i=e.getContext("2d"),n=2*r+2*t;return e.width=n,e.height=n,i.fillStyle="white",i.beginPath(),i.arc(r+t,r+t,r,0,2*Math.PI),i.fill(),new Ke(e)}let wt=vt(32,8),A=new I;A.setAttribute("position",new V(Ue.slice(),3));let re=new S({color:13505562,size:.04,map:wt,transparent:!0,opacity:.5,depthWrite:!1}),yt=new C(A,re);fe.add(yt);let te=0,ne=0;function Be(){requestAnimationFrame(Be);let r=k.attributes.position.array;for(let e=0;e<M;e++)for(let i=0;i<M;i++){let n=3*(e*M+i),o=Math.sin(e*R+te)*Math.cos(i*R+te)*B*.3;r[n+1]=o}k.attributes.position.needsUpdate=!0;let t=A.attributes.position.array;for(let e=0;e<M;e++)for(let i=0;i<M;i++){let n=3*(e*M+i),o=Math.sin(e*R+ne)*Math.cos(i*R+ne)*B*.4;t[n+1]=o}A.attributes.position.needsUpdate=!0,Ie.render(fe,ge),te+=.01,ne+=.005}Be();let se=new D,ve=new T(55,window.innerWidth/window.innerHeight,.1,1e3),De=new W({canvas:document.querySelector("#coral-canvas")});De.setSize(innerWidth/3,innerHeight/3);ve.position.set(2.5,1,0);ve.lookAt(0,1,0);let we=new S({color:12774655,size:.001,transparent:!0,opacity:.1});const xt=new X;xt.load("./model/coral.obj",r=>{r.children.forEach(t=>{let e=new C(t.geometry,we);e.position.set(0,0,0),se.add(e)})});let ae=new D,ye=new T(55,window.innerWidth/window.innerHeight,.1,1e3),Te=new W({canvas:document.querySelector("#algae-canvas")});Te.setSize(innerWidth/3,innerHeight/3);ye.position.set(2.5,1,0);ye.lookAt(0,1,0);const bt=new X;bt.load("./model/algae.obj",r=>{r.children.forEach(t=>{let e=new C(t.geometry,we);e.position.set(0,0,0),ae.add(e)})});let le=new D,xe=new T(42,window.innerWidth/window.innerHeight,.1,1e3),We=new W({canvas:document.querySelector("#fish-canvas")});We.setSize(innerWidth/3,innerHeight/3);xe.position.set(2.5,0,0);xe.lookAt(0,.5,0);const jt=new X;jt.load("./model/fish.obj",r=>{r.children.forEach(t=>{let e=new C(t.geometry,we);e.position.set(0,0,0),le.add(e)})});function Ne(){requestAnimationFrame(Ne),De.render(se,ve),se.rotation.y+=.001,Te.render(ae,ye),ae.rotation.y+=.001,We.render(le,xe),le.rotation.y+=.001}Ne();const qe=`
varying vec2 vertexUV;
varying vec3 vertexNormal;

void main(){
    vertexUV = uv;
    vertexNormal = normalize(normalMatrix * normal);
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,Mt=`
uniform sampler2D globeTexture;

varying vec2 vertexUV;
varying vec3 vertexNormal;

void main(){
    float intensity = 1.05 - dot(vertexNormal, vec3(0.0, 0.0,1.0));
    vec3 atmosphere = vec3(0.3, 0.6, 1.0) * pow(intensity, 1.5);
    //vec3: change the color of atmosphere

    gl_FragColor = vec4(atmosphere + texture2D(globeTexture,vertexUV).xyz, 1.0);
}
`,Ct=`
uniform sampler2D globeTexture;
varying vec2 vertexUV;

void main() {
    vec4 textureColor = texture2D(globeTexture, vertexUV);
    gl_FragColor = textureColor;
}
`,Ft=`
varying vec3 vertexNormal;

void main(){
    vertexNormal = normalize(normalMatrix * normal) ;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,St=`
varying vec3 vertexNormal;
void main(){
    float intensity = pow(0.5 - dot(vertexNormal, vec3(0, 0, 1.0)),2.5);

    gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0)*intensity;
}
`,O=new D,Oe=new T(85,innerWidth/innerHeight,.1,1e3),be=new W({antialias:!0,alpha:!0,canvas:document.querySelector("#earth-container")});be.setSize(innerWidth,innerHeight);be.setPixelRatio(window.devicePixelRatio);const zt=`
  attribute float size;
  attribute vec3 customColor;
  varying vec3 vColor;
  void main() {
    vColor = customColor;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_PointSize = size * ( 300.0 / -mvPosition.z );
    gl_Position = projectionMatrix * mvPosition;
  }
`,Vt=`
  varying vec3 vColor;
  void main() {
    float r = 0.0, delta = 0.0, alpha = 1.0;
    vec2 cxy = 2.0 * gl_PointCoord - 1.0;
    r = dot(cxy, cxy);
    if (r > 1.0) {
      discard;
    }
    gl_FragColor = vec4(vColor, 1.0 - r);
    alpha = 1.0 - r;
    if ( alpha < 0.9 ) discard;
  }
`;new Y({vertexShader:zt,fragmentShader:Vt,blending:Ae,depthTest:!1,transparent:!0,vertexColors:!0});const Pt=new E(new he(1,50,50),new Y({vertexShader:qe,fragmentShader:Mt,uniforms:{globeTexture:{value:new _e().load("./img/blueearth.jpg")}}})),je=new E(new he(1,50,50),new Y({vertexShader:qe,fragmentShader:Ct,uniforms:{globeTexture:{value:new _e().load("./img/outline2.png")}},transparent:!0}));je.scale.set(1.02,1.02,1.02);O.add(je);const Ge=new E(new he(1,50,50),new Y({vertexShader:Ft,fragmentShader:St,blending:Ae,side:Qe}));Ge.scale.set(1.3,1.3,1.3);O.add(Ge);const x=new de;x.add(Pt);x.add(je);O.add(x);Oe.position.z=2.3;let Me=!1,$={x:0,y:0},L={x:0,y:0};addEventListener("mousedown",r=>{Me=!0,$.x=r.clientX,$.y=r.clientY,L.x=x.rotation.x,L.y=x.rotation.y});const Lt=document.querySelector("canvas");Lt.addEventListener("mousemove",r=>{if(Me){let t=(r.clientX-$.x)/(innerWidth*6),e=(r.clientY-$.y)/(innerHeight*6);L.x+=e*.5,L.y+=t*.5,L.x=Math.max(-Math.PI/4,Math.min(Math.PI/4,L.x)),ue.to(x.rotation,{x:L.x,y:L.y,duration:.5})}});addEventListener("mouseup",()=>{Me=!1});const At=document.querySelector("#reset-button");At.addEventListener("click",()=>{ue.to(x.rotation,{x:0,y:0,duration:1})});let _;function _t(r){x.remove(x.getObjectByName("points"));let t=x.getObjectByName("dataCylinder");for(;t;)x.remove(t),t=x.getObjectByName("dataCylinder");et(`./dataset/average/${r}_averaged_data.csv`).then(e=>{let i=new I,n=new Float32Array(e.length*3),o=new Float32Array(e.length*3);const l=tt().domain([7.95,8.03,8.06,8.12,8.14,8.4]).range(["#ff0000","#F9D6A5","#ffffff","#87CFFB","#4C9EED"]);e.forEach((c,a)=>{c.latitude=+c.latitude,c.longitude=360-+c.longitude,c.pH=+c.pH;let h=(90-Math.abs(c.latitude))*(Math.PI/180),s=c.longitude*(Math.PI/180),d=1,f=d*Math.sin(h)*Math.cos(s),g=c.latitude>=0?d*Math.cos(h):-d*Math.cos(h),u=d*Math.sin(h)*Math.sin(s),v=new Le(l(c.pH));if(c.pH<8){let w=(8-c.pH)*2.4,y=new nt(.002,.002,w,32),N=new it({color:16545280});_=new E(y,N);let m=new F(f,g,u).clone().normalize().multiplyScalar(d+w/2);_.position.set(m.x,m.y,m.z),_.lookAt(new F(0,0,0)),_.rotateX(Math.PI/2),_.name="dataCylinder",x.add(_)}n[3*a]=f,n[3*a+1]=g,n[3*a+2]=u,o[3*a]=v.r,o[3*a+1]=v.g,o[3*a+2]=v.b}),i.setAttribute("position",new ie(n,3)),i.setAttribute("color",new ie(o,3));const p=new C(i,new S({vertexColors:!0,size:.038}));x.add(p)})}_t(2011);const Re=5e3,ke=new I,ce=new Float32Array(Re*3);for(let r=0;r<ce.length;r++)ce[r]=(Math.random()-.5)*20;ke.setAttribute("position",new ie(ce,3));const Ht=new S({color:16777215,size:.005}),q=new C(ke,Ht);O.add(q);function $e(){q.geometry.attributes.position.needsUpdate=!0;for(let r=0;r<Re;r++){let t=r*3;q.geometry.attributes.position.array[t+0]+=(Math.random()-.5)*.001,q.geometry.attributes.position.array[t+1]+=(Math.random()-.5)*.001,q.geometry.attributes.position.array[t+2]+=(Math.random()-.5)*.001}requestAnimationFrame($e),be.render(O,Oe),x.rotation.y+=4e-4,ue.to(x.rotation,{duration:1})}$e();
